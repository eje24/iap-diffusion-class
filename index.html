<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="og:url" content="http://localhost:4000/">
  <meta property="og:site_name" content="Missing Semester">

  

  
  <meta name="twitter:title" content="Generative AI with Stochastic Differential Equations - IAP 2025">
  <meta property="og:title" content="Generative AI with Stochastic Differential Equations - IAP 2025">

  

  <title>
    
      
       Flow Matching and Diffusion Models
      
    
  </title>
  <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
	<link rel="manifest" href="favicons/site.webmanifest">

  <link rel="stylesheet" href="./main.css">
  <link rel="stylesheet" href="/static/css/syntax.css">
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,900&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P7WVHD84D1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-P7WVHD84D1');
  </script>

</head>


  <body>

    <div id="nav-bg">
  <nav id="top-nav" style='flex-grow: 0;'>
  <a href="#content" id="site-title" class="pull-left">
	  <img src="./favicon.png" height=35>
  </a>
  <ul id="navigation-list" class="pull-right navbar-ul" style="list-style-type: none !important;">
    <li class="pull-left navbar-list">
      <a href="#notes"> Notes </a>
    </li>
    <li class="pull-left navbar-list">
      <a href="#lectures"> Lectures </a>
    </li>
    <li class="pull-left navbar-list">
      <a href="#labs"> Labs </a>
    </li>
    <li class="pull-left navbar-list">
      <a href="#instructors"> Instructors </a>
    </li>
  </ul>
  </nav>

<!-- <div id="content">
  <h1 class="title">An Introduction to Flow Matching and Diffusion Models</h1>
  <h2 class="subtitle">"Generative AI with Stochastic Differential Equations - - MIT IAP 2025"</h2>
  <p>
    Diffusion and flow-based models have become the state of the art for generative AI across a wide range of data modalities, including images, videos, shapes, molecules, music, and more! This course aims to build up the mathematical framework underlying these models from first principles. At the end of the class, students will have built a toy image diffusion model from scratch, and along the way, will have gained hands-on experience with the mathematical toolbox of stochastic differential equations that is useful in many other fields. This course is ideal for students who want to develop a principled understanding of the theory and practice of generative AI.
  </p>
</div> -->
</div>


    <div id="content">
    <h1 class="title">Introduction to Flow Matching and Diffusion Models</h1>
    <h2 style="font-style:italic">MIT Computer Science Class 6.S184: Generative AI with Stochastic Differential Equations</h2>
<p>
Diffusion and flow-based models have become the state of the art for generative AI across a wide range of data modalities, including images, videos, shapes, molecules, music, and more! This course aims to build up the mathematical framework underlying these models from first principles. At the end of the class, students will have built a toy image diffusion model from scratch, and along the way, will have gained hands-on experience with the mathematical toolbox of stochastic differential equations that is useful in many other fields. This course is ideal for students who want to develop a principled understanding of the theory and practice of generative AI.
<p>

<!-- <div style="border: 1px solid #ccc; background-color: #f9f9f9; padding: 15px; margin: 20px 0; text-align: center; border-radius: 5px;">
    <a href="https://student.mit.edu/cgi-docs/student.html" target="_blank" style="color: #007bff; text-decoration: none; font-weight: bold;">Sign up here to take this course!</a>
</div> -->

<h1 id="notes">Course Notes</h1>
  <p>
  The course notes serve as the backbone of the course and provide a self-contained explanation of all material in the class. In contrast, lectures slides will generally not be self-contained and are intended to provide accompanying visualizations during the lecture. You may view the notes by clicking on the colored link below.
  <div style="display: flex; justify-content: center;"> 
  <a href="docs/lecture-notes.pdf" target="_blank"
     style="display:inline-block;padding:0.3em 1em;
            background-color:#ff9500;color:#020202;
            text-decoration:none;border-radius:4px;"> 
	View the course notes here!
  </a>
  </div>
  </p>

<h1 id="lectures">Lectures</h1>
<table class="schedule-table">
  <tr>
    <th>Lecture</th>
    <th>Topic</th>
    <th>Slides</th>
    <th>Recording</th>
  </tr>
  
  <tr>
    <td>1</td>
    <td>
      <span class="lecture-title">Flow and Diffusion Models</span>
      <ul class="lecture-points">
        <li>Introduction to Generative Models</li>
        <li>Ordinary and Stochastic Differential Equations</li>
        <li>Sampling from Flow and Diffusion Models</li>
      </ul>
    </td>
    <td><a href="docs/slides_lecture_1.pdf" target="_blank">[slides 1]</a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/bBA0Ueb80hg" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=bBA0Ueb80hg" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>

  <tr>
    <td>2</td>
    <td>
      <span class="lecture-title">Constructing a Training Target</span>
      <ul class="lecture-points">
        <li>Conditional and Marginal Probability Paths</li>
        <li>Continuity Equation and Fokker-Planck Equation</li>
        <li>Marginal Vector Field and Marginal Score Function</li>
      </ul>
    </td>
    <td><a href="docs/slides_lecture_2.pdf" target="_blank">[slides 2]</a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/VIDEO_ID_2" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=VIDEO_ID_2" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>

  <tr>
    <td>3</td>
    <td>
      <span class="lecture-title">Training Flow and Diffusion Models</span>
      <ul class="lecture-points">
        <li>Flow Matching</li>
        <li>Score Matching</li>
        <li>Various Approaches to Diffusion Models</li>
      </ul>
    </td>
    <td><a href="docs/slides_lecture_3.pdf" target="_blank">[slides 3]</a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=VIDEO_ID_3" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>
  <tr>
    <td>4</td>
    <td>
      <span class="lecture-title">Building an Image Generator</span>
      <ul class="lecture-points">
        <li>Guidance and Conditional Generation</li>
        <li>Neural network architectures</li>
        <li>Survey of State-of-the-art Models</li>
      </ul>
    </td>
    <td><a href="docs/slides_lecture_4.pdf" target="_blank"> [slides 4] </a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=VIDEO_ID_3" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>
  <tr>
    <td>5</td>
    <td>
      <span class="lecture-title">Generative Robotics</span>
      <ul class="lecture-points">
        <li>Guest lecture by Benjamin Burchfiel (Toyota Research)</li>
        <li>Large Behaviour Models</li>
        <li>Diffusion Models for Robotics</li>
      </ul>
    </td>
    <td><a href="" target="_blank"> [NaN]</a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=VIDEO_ID_3" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>
  <tr>
    <td>6</td>
    <td>
      <span class="lecture-title">Generative Protein Design</span>
      <ul class="lecture-points">
        <li>Guest lecture by Jason Yim (MIT)</li>
        <li>Designing new proteins with AI</li>
        <li>Flow matching for protein structure generation</li>
      </ul>
    </td>
    <td><a href="docs/slides_lecture_6.pdf" target="_blank"> [slides 6]</a></td>
    <td>
      <iframe class="video-embed" src="https://www.youtube.com/embed/VIDEO_ID_3" frameborder="0" allowfullscreen></iframe>
      <br>
      <!-- <a href="https://www.youtube.com/watch?v=VIDEO_ID_3" target="_blank" class="watch-youtube">▶ Watch on YouTube</a> -->
    </td>
  </tr>
</table>

<!-- <table class="schedule-table">
  <tr>
    <th>Lecture</th>
    <th>Topic</th>
    <th>Slides</th>
    <th>Recording</th>
  </tr>
  <tr>
    <td>Lecture 1</td>
    <td>Flow and Diffusion Models</td>
    <td><a href="docs/slides_lecture_1.pdf" target="_blank">[Slides]</a></td>
    <td>
      <div style="position: relative; display: inline-block;">
        <iframe width="280" height="157" src="https://www.youtube.com/embed/bBA0Ueb80hg?si=dqakGUwXyPAa5RsL" 
            title="YouTube video player" frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
        </iframe>
        
        <a href="https://www.youtube.com/watch?v=bBA0Ueb80hg" target="_blank" 
           style="position: absolute; bottom: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                  color: white; padding: 4px 8px; text-decoration: none; border-radius: 3px; font-size: 12px;">
            Watch on YouTube
        </a>
    </div>
  </td>
  </tr>
  <tr>
    <td>Lecture 2</td>
    <td>Constructing a Training Target</td>
    <td><a href="docs/slides_lecture_1.pdf" target="_blank">[Slides]</a></td>
    <td>
      <div style="position: relative; display: inline-block;">
        <iframe width="280" height="157" src="https://www.youtube.com/embed/bBA0Ueb80hg?si=dqakGUwXyPAa5RsL" 
            title="YouTube video player" frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
        </iframe>
        
        <a href="https://www.youtube.com/watch?v=bBA0Ueb80hg" target="_blank" 
           style="position: absolute; bottom: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                  color: white; padding: 4px 8px; text-decoration: none; border-radius: 3px; font-size: 12px;">
            Watch on YouTube
        </a>
    </div>
  </td>
  </tr>
  <tr>
    <td>Lecture 3</td>
    <td>Flow Matching and Score Matching</td>
    <td><a href="docs/slides_lecture_1.pdf" target="_blank">[Slides]</a></td>
    <td>
      <div style="position: relative; display: inline-block;">
        <iframe width="280" height="157" src="https://www.youtube.com/embed/bBA0Ueb80hg?si=dqakGUwXyPAa5RsL" 
            title="YouTube video player" frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
        </iframe>
        
        <a href="https://www.youtube.com/watch?v=bBA0Ueb80hg" target="_blank" 
           style="position: absolute; bottom: 5px; right: 5px; background: rgba(0,0,0,0.7); 
                  color: white; padding: 4px 8px; text-decoration: none; border-radius: 3px; font-size: 12px;">
            Watch on YouTube
        </a>
    </div>
  </td>
  </tr>
</table> -->
<!-- <strong>Lectures</strong>: Lectures will be held from 11:00am - 12:30pm, in Room <a href="https://whereis.mit.edu/?go=E25"> E25-111</a>. Notes, slides, and video recordings will be linked below once available. Registered students may also view recordings on Canvas via Panopto.<br />
<ul>
    <li>
    <strong>Tuesday, 1/21/2025</strong>: Flow and Diffusion Models <a href="docs/lecture-notes.pdf" style="color: rgb(255, 196, 0);">[notes]</a><a href="docs/slides_lecture_1.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a> <a href="https://mit.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=33a0af0b-dd76-4213-b033-b26700e17e3f" style="color: rgb(255, 196, 0);">[recording</a>]
    </li>
    <li>
        <strong>Wed, 1/22/2025</strong>: The Marginal Vector Field and Score <a href="docs/lecture-notes.pdf" style="color: rgb(255, 196, 0);">[notes]</a><a href="docs/slides_lecture_2.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a> <a href="https://mit.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=33a0af0b-dd76-4213-b033-b26700e17e3f" style="color: rgb(255, 196, 0);">[recording</a>]
    </li>
    <li>
        <strong>Thu, 1/23/2025</strong>: Flow Matching and Score Matching <a href="docs/lecture-notes.pdf" style="color: rgb(255, 196, 0);">[notes]</a><a href="docs/slides_lecture_3.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a> <a href="https://mit.hosted.panopto.com/Panopto/Pages/Sessions/List.aspx?folderID=33a0af0b-dd76-4213-b033-b26700e17e3f" style="color: rgb(255, 196, 0);">[recording</a>]
    </li>
    <li>
        <strong>Monday, 1/27/2025</strong>: Conditional Image Generation<a href="docs/lecture-notes.pdf" style="color: rgb(255, 196, 0);">[notes]<a><a href="docs/slides_lecture_4.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a> <a href="https://mit.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=39574796-6c7a-4691-8e9a-b26700e2c8f2" style="color: rgb(255, 196, 0);">[recording</a>]
        <ul>
          <li> Classifier-Free Guidance
          <li> Neural Network Architectures
          <li> Alignment: Carles Domingo-Enrich (Microsoft Research) <a href="docs/guest_slides_lecture_4.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a>
          </li>
      </ul>
    </li>
    <li>
        <strong>Thursday, 1/30/2025</strong>: Guest lecture: Diffusion models across applications.
        <ul>
            <li> Robotics: Benjamin Burchfiel (Toyota Research Institute) <a href="https://mit.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=39574796-6c7a-4691-8e9a-b26700e2c8f2" style="color: rgb(255, 196, 0);">[recording</a>] </li> 
            <li> Protein design: Jason Yim (MIT) <a href="docs/slides_lecture_5_jason.pdf" target="_blank" style="color: rgb(255, 196, 0);">[slides]</a> <a href="https://mit.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=39574796-6c7a-4691-8e9a-b26700e2c8f2" style="color: rgb(255, 196, 0);">[recording</a>] </li>
        </ul>
    </li>
</ul> -->

<!-- <strong>Office hours</strong>: Office hours will be held at the following dates and times:
<ul>
    <li>
    <strong>Week One</strong>: 
    <ul>
    <li>  1/22/2025 @ 3:00pm-4:30pm (Room <a href="https://whereis.mit.edu/?go=37">37-212 </a>)
    <li>  1/24/2025 @ 11:00am-12:30pm (Room <a href="https://whereis.mit.edu/?go=37">37-212 </a>)
    </ul>
    </li>
    <li>
    <strong>Week Two</strong>: 
    <ul>
      <li> 1/28/2025 @ 11:00am-12:30pm (Room <a href="https://whereis.mit.edu/?go=E25">E25-111 </a>)
      <li> 1/29/2025 @ 11:00am-12:30pm (Room <a href="https://whereis.mit.edu/?go=37">37-212 </a>)
      <li> 1/31/2025 @ 11:00am-12:30pm (Room <a href="https://whereis.mit.edu/?go=37">37-212 </a>)
      </ul>
    </li>
</ul> -->

</p>

<h1 id="labs">Labs</h1>

There are 3 <b>labs</b> given as exercises accompanying the class to give you <b>hands-on practical experience</b>. The labs will guide you through building a flow matching and diffusion model from scratch step-by-step. To do the exercises, perform the following steps:
<ol>
  <li>Click on the <b>"Open in Colab"</b> link to open the lab in Google Drive.</li>
  <li>Click on the <b>"Open in Google Colaboratory"</b> link at the center top of the page. A jupyter notebook should appear.</li>
  <li>Click on <b>"File" → "Save a copy in Drive"</b> to save a copy of the lab to your own Google Drive.</li>
  <li>Follow the instructions in the lab to complete the exercises.</li>
</ol>


<div class="labs-container">
  <div class="lab-card">
    <h3>Lab 1: Working with SDEs</h3>
    <a href="https://drive.google.com/file/d/1kT_epFEuPD_uAHzKVWufovMf5Ro0lER1/view?usp=sharing" 
       class="colab-button" target="_blank">
      <img src="https://colab.research.google.com/img/colab_favicon_256px.png" class="colab-logo">
      Open in Colab
    </a>
  </div>

  <div class="lab-card">
    <h3>Lab 2: Flow Matching and Score Matching</h3>
    <a href="https://drive.google.com/file/d/1Su2zbsubk0GB7obELDLpD7vHmE2huW-_/view?usp=sharing" 
       class="colab-button" target="_blank">
      <img src="https://colab.research.google.com/img/colab_favicon_256px.png" class="colab-logo">
      Open in Colab
    </a>
  </div>

  <div class="lab-card">
    <h3>Lab 3: Conditional Image Generation</h3>
    <a href="https://drive.google.com/file/d/1crSvL3ongtw0H0qO1DhnfQHW-biTasGb/view?usp=sharing" 
       class="colab-button" target="_blank">
      <img src="https://colab.research.google.com/img/colab_favicon_256px.png" class="colab-logo">
      Open in Colab
    </a>
  </div>
</div>

<p style="text-align: left; margin-top: 20px;">
  <strong>Stuck?</strong> Solutions can be found 
  <a href="https://github.com/eje24/iap-diffusion-labs" style="color: #ff9500;">here</a>.
</p>

<!-- <h1 id="labs">Labs</h1>

There will be 3 <b>labs</b> given as homework which culminate in a conditional flow matching model. The labs will guide you through building this model from scratch step-by-step.

<ul>
  <li>
    <strong> Lab 1</strong>:
    Working with SDEs [<a href="https://drive.google.com/file/d/1kT_epFEuPD_uAHzKVWufovMf5Ro0lER1/view?usp=sharing"style="color: rgb(255, 196, 0);">Colab</a>]
  </li>
  <li>
    <strong> Lab 2</strong>:
    Flow Matching and Score Matching [<a href="https://drive.google.com/file/d/1Su2zbsubk0GB7obELDLpD7vHmE2huW-_/view?usp=sharing"style="color: rgb(255, 196, 0);">Colab</a>]

  </li>
  <li>
    <strong> Lab 3</strong>:
    Conditional Image Generation [<a href="https://drive.google.com/file/d/1crSvL3ongtw0H0qO1DhnfQHW-biTasGb/view?usp=sharing"style="color: rgb(255, 196, 0);">Colab</a>]

  </li>
</ul>
Stuck? Solutions can be found <a href="https://github.com/eje24/iap-diffusion-labs">here</a>. -->

<!-- <h1 id="schedule">Grading<a id="schedule"></a></h1> -->
<!---->
<!-- Grading will be P/D/F, 18 points and above required to receive credit. The total points are calculated as follows: -->
<!-- <ul> -->
<!-- <li> Participation/attendance (10 points)  -->
<!-- </li> -->
<!-- <li>  -->
<!--     Labs (15 points, 5 points each) -->
<!-- </li> -->
<!-- </ul> -->


<h1 id="instructors">Instructors<a id="instructors"></a></h1>
<p>This class was co-taught by <a href="https://www.peterholderrieth.com/">Peter</a> and <a href="https://eerives.me/">Ezra</a>. We are fortunate to have <a href="https://people.csail.mit.edu/tommi/">Tommi Jaakkola</a> as our sponsor and advisor.<br /></p>

<div class="instructors">
  <div class="instructor">
    <img src="./peter.jpeg" alt="Instructor Photo" class="instructor-photo" />
    <a href="https://www.peterholderrieth.com/" class="instructor-name">Peter Holderrieth</a>
    <p class="instructor-title">PhD Student</p>
  </div>
  <div class="instructor">
    <img src="./ezra.jpeg" alt="Instructor Photo" class="instructor-photo" />
    <a href="https://eerives.me" class="instructor-name">Ezra Erives</a>
    <p class="instructor-title">MEng Student</p>
  </div>
</div>
 
<p><strong>Prerequisites:</strong> Linear algebra, real analysis, and basic probability theory. Students should be familiar with Python and have some experience with PyTorch.

<p><strong>Questions?</strong> Email either <a href="mailto:phold@mit.edu">Peter</a> or <a href="mailto:erives@mit.edu">Ezra</a>!</p>

<p><strong>Remark about LLMs:</strong> This course does not cover large language models (LLMs). LLMs involve discrete data such as text, while this course focuses on data lying in continuous spaces such as images, videos, and protein structures. 

<h2 id="acknowledgements">Acknowledgements</h2>
<p>We would like to thank Professor <a href="https://people.csail.mit.edu/tommi/">Tommi Jaakkola</a> and <a href="https://www.eecs.mit.edu/">MIT EECS</a> without whose support this class would not be possible. We would like to thank Christian Fiedler, Tim Griesbach, Benedikt Geiger, and Albrecht Holderrieth for value feedback on the lecture notes. Further, we thank Elaine Mello from MIT Open Learning for support with lecture recordings and Ashay Athalye from Students for Open and Universal Learning for helping to cut and process the videos. We would additionally like to thank Cameron Diao, Tally Portnoi, Andi Qu, and many others for providing invaluable feedback on the labs. We would also like to thank Lisa Bella, Ellen Reid, and everyone else at MIT EECS for their generous support. Finally, we would like to thank all participants in the original course offering (MIT 6.S184/6.S975, taught over IAP 2025), as well as readers like you for your interest in this class. Finally,  We would also like to thank <a href="https://github.com/missing-semester/missing-semester">The Missing Semester of Your CS Education</a> upon whose website this one was inspired.</p>
<hr />

<div class="small center">
<p><a href="https://github.com/eje24/iap-diffusion-class/">Source code</a>.</p>
<p>Licensed under CC BY-NC-SA.</p>
</div>


    </div>

  </body>

</html>

